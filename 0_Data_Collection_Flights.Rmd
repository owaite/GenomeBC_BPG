
# Data Collection and Flights

## Hardware - DJI Matrice 3000 RTK (M300)

```{r M300-flying, echo=FALSE, out.width="100%", fig.cap = "DJI Matrice 300 RTK in flight over one of our Vancouver Island feild sites, taken by Alec Liu with a Mavic3."}
knitr::include_graphics("C:\\Users\\owaite\\OneDrive - NRCan RNCan\\Documents\\GitHub\\GenomeBC_BPG\\Photos_&_gifs\\M300_flying.png")
```

A complete SOP for mapping flights with the M300 was developed in-house and can be found in the [SOPs folder](https://github.com/owaite/GenomeBC_BPG/tree/main/SOPs) on GitHub. Transport Canada (TC) regulations require logging all flights and to have the logs on-hand when flying. We have developed a simple spreadsheet that logs the details required by TC and other useful details for each flight. When undertaking a project with repeated data collection campaigns, we would recommend developing a similar approach to organizing these data.  A copy of the one we use is available within the [Example Documents](https://github.com/owaite/GenomeBC_BPG/tree/main/Example_Documents) folder on GitHub. 




## Workflow: Site Reconnaissance 
Ahead of the first data collection flights we follow the reconnaissance workflow outlined in Figure \@ref(fig:Reconnasissance-flowDiagram)


```{r Reconnasissance-flowDiagram, echo=FALSE, out.width="100%", fig.cap = "Reconnaissance workflow."}
knitr::include_graphics("C:\\Users\\owaite\\OneDrive - NRCan RNCan\\Documents\\GitHub\\GenomeBC_BPG\\Photos_&_gifs\\Reconnasissance_flowDiagram.PNG")
```


## Data Collection: Flight Planning  


### Flight planning theory 

Figure \@ref(fig:effective-overlap) outlines the difference in ground overlap and canopy overlap.  We have developed a calculator in which you enter the flight altitude, overlaps, and canopy height and it will output the canopy overlap.  You can then adjust the inputs until you get the required overlap. It is available in the [Example Documents](https://github.com/owaite/GenomeBC_BPG/tree/main/Example_Documents) folder on GitHub. Figure \@ref(fig:effective-overlap) below is an example calculation detailed in the next paragraph.    

```{r effective-overlap, echo=FALSE, out.width="100%", fig.cap = "Effective overlap calculation."}
knitr::include_graphics("C:\\Users\\owaite\\OneDrive - NRCan RNCan\\Documents\\GitHub\\GenomeBC_BPG\\Photos_&_gifs\\effective_overlap.png")
```





### Flight planning with DJI Pilot 

Figure \@ref(fig:P1-flightPlan)

```{r P1-flightPlan, echo=FALSE, out.width="100%", fig.cap = "Flight planning a P1 flight on the remote controller."}
knitr::include_graphics("C:\\Users\\owaite\\OneDrive - NRCan RNCan\\Documents\\GitHub\\GenomeBC_BPG\\Photos_&_gifs\\P1_flight_plan.png")
```

## Data Collection: Sensors, Parameters, and Ideal Conditions 
### MicaSense: 10-Band Spectral Sensor for Vegetative Indices 

Figure \@ref(fig:DLS-Micasense-connection)

```{r DLS-Micasense-connection, echo=FALSE, out.width="100%", fig.cap = "Micasense RedEdge-MX Dual and the DLS2 mounted on the M300. Here we are connecting the DLS2 to the Micasense camera."}
knitr::include_graphics("C:\\Users\\owaite\\OneDrive - NRCan RNCan\\Documents\\GitHub\\GenomeBC_BPG\\Photos_&_gifs\\DLS2_Micasense_connection.png")
```
**Sensor Specifications:** 

- **Camera Type:** MicaSense Dual cameras 

- **Image Format:** .tif with a suffix indicating the band (e.g., _1, _2) 

- **Bands/Wavelengths:** 

```{r MS-Table, echo = FALSE}
data <- data.frame(
  Band_Name  = c("Blue",
                 "Green",
                 "Red",
                 "Red Edge",
                 "NIR",
                 "Panchromatic",
                 "Coastal Blue",
                 "Green",
                 "Red",
                 "Red Edge",
                 "Red Edge"
                 
  ),
  Center_Wavelength = c("475",
                        "560",
                        "668",
                        "717",
                        "842",
                        "634",
                        "444",
                        "531",
                        "650",
                        "705",
                        "740"
  ),
  Bandwidth = c("32",
                "27",
                "14",
                "12",
                "57",
                "463",
                "28",
                "14",
                "16",
                "10",
                "18"
  ),
  Camera = c("Red",
             "Red",
             "Red",
             "Red",
             "Red",
             "Red",
             "Blue",
             "Blue",
             "Blue",
             "Blue",
             "Blue"
  )
  
  
)
# Create the table and center it
kable(data, col.names = c("Band Name", "Center Wavelength (nm)","Bandwidth (nm)","Camera"),caption = 'Band names, center wavelengths, and bandwidths collected by the Red and Blue cameras within the Micasense Dual camera systems. Panchro* is only available in the pan chromatic models.')

```

- **Image Capture Rate:** 

  - The default setting for timed intervals is one image capture every two seconds, with simultaneous capture for all bands. 

  - The capture rate can be adjusted to a maximum of one image per second 

- **Output:** 5-6 folders per camera (10-12 thousand images) for a 25â€“30-minute flight covering a 1.5-2 Ha site 

- **GSD:** 2.5-4cm at 40m above canopy.  1.5-2cm when processed pansharpened with the panchromatic band.  

**Flight Parameters: **

- **Flight Elevation: **

  - 40 m above canopy 

- **Flight Speed:** ~2 m/s (slower speeds reduce motion blur, especially in windy conditions) 

- **Image Overlap:** Extra high to ensure sufficient coverage and allow for exclusion of poor-quality images during processing. 

  - Front: ~86% (timed interval is the limiting factor) 

  - Side: ~86%  

- **Margins:** 10 m around the site perimeter is sufficient for flight planning due to the wide-angle shot of the MS camera 

- **Flight Time:** Approximately 30 minutes for a 1.5-2 Ha area site.  This allows for a single battery flight, which helps to maintain even light conditions. 

**Best Practices: **

- **Weather Conditions:** Avoid flying in any precipitation as MicaSense cameras are unprotected from moisture, with exposed data and power connections. 

- **Lighting:** Conduct flights within two hours of solar noon to minimize shadowing in the imagery. 

The DLS calibration helps to reduce the effect changing light conditions, but extreme changes in light conditions will leave residual effects that are difficult to process out. The figures below show a flight in variable conditions on top in which the calibration has failed to correct the changing light conditions.  The bottom image is on an ideal day with even diffuse light.  